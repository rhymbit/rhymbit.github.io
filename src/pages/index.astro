---
import HomepageHero from "@/components/page-components/homepage/homepage-hero/homepage-hero.astro";
import HomepagePostCard from "@/components/page-components/homepage/homepage-post-card/homepage-post-card.astro";
import SearchPosts from "@/components/search-posts/search-posts.astro";
import BaseLayout from "@/layouts/base-layout.astro";
import { getCollection } from "astro:content";

const allPosts = await getCollection("posts");
---

<BaseLayout class="flex flex-col">
  <main
    class="px-5 py-10 w-full h-full grow flex flex-col items-center gap-y-10 overflow-x-clip 2xl:gap-y-20"
  >
    <HomepageHero />

    <div>
      <SearchPosts />
    </div>

    <section class="max-w-7xl flex-center flex-col gap-y-5">
      <section class="my-10 md:columns-2 lg:columns-3 space-y-4">
        {
          allPosts
            .sort((a, b) => {
              const dateA = new Date(a.data.pubDate);
              const dateB = new Date(b.data.pubDate);
              return dateB.getTime() - dateA.getTime();
            })
            .slice(0, 9)
            .map((post) => (
              <div class="break-inside-avoid">
                <HomepagePostCard post={post} />
              </div>
            ))
        }
      </section>
    </section>
  </main>
</BaseLayout>
