---
import HomepagePostCard from "@/components/page-components/homepage/homepage-post-card/homepage-post-card.astro";
import SearchPosts from "@/components/search-posts/search-posts.astro";
import BaseLayout from "@/layouts/base-layout.astro";
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import logo from "@/assets/logo/logo_64.png";
import logoBig from "@/assets/logo/logo_96.png";

const allPosts = await getCollection("posts");
---

<BaseLayout class="flex flex-col">
  <main
    class="px-5 py-10 w-full h-full grow flex flex-col items-center gap-y-10 overflow-x-clip 2xl:gap-y-20"
  >
    <div
      class="group max-w-3xl 3xl:max-w-7xl flex flex-col gap-y-4 text-center select-none"
    >
      <h1 class="flex-center gap-x-1 font-bold font-shantell-sans">
        <Image src={logo} alt="Logo" class="lg:hidden" />
        <Image
          src={logoBig}
          alt="Logo"
          class="hidden lg:inline group-hover:rotate-720 transition duration-700"
        />
        rhymbit
      </h1>
      <p class="text-h6">
        Search for posts using <Icon
          name="index-finger-pointing"
          class="inline text-h4 rotate-180"
        /> or browse all posts using <Icon
          name="index-finger-pointing"
          class="inline text-h4 rotate-45"
        />
      </p>
    </div>

    <div>
      <SearchPosts />
    </div>

    <section class="max-w-7xl flex-center flex-col gap-y-5">
      <section class="my-10 md:columns-2 lg:columns-3 space-x-0 space-y-10">
        {
          allPosts
            .sort((a, b) => {
              const dateA = new Date(a.data.pubDate);
              const dateB = new Date(b.data.pubDate);
              return dateB.getTime() - dateA.getTime();
            })
            .slice(0, 9)
            .map((post) => (
              <div class="break-inside-avoid">
                <HomepagePostCard post={post} />
              </div>
            ))
        }
      </section>
    </section>
  </main>
</BaseLayout>
