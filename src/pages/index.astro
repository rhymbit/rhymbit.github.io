---
import HomepagePostCard from "@/components/page-components/homepage/homepage-post-card/homepage-post-card.astro";
import SearchPosts from "@/components/search-posts/search-posts.astro";
import BaseLayout from "@/layouts/base-layout.astro";
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";

const allPosts = await getCollection("posts");
---

<BaseLayout class="flex flex-col">
  <main
    class="px-2 py-10 w-full h-full grow flex flex-col items-center gap-y-10 overflow-x-clip 2xl:gap-y-20"
  >
    <div class="max-w-3xl 3xl:max-w-7xl flex flex-col gap-y-4 text-center">
      <h4 class="font-bold">
        I Just Write About What I'm Learning or Have Learned.
      </h4>
      <p class="text-h6">
        Search for posts using <Icon name="index-finger-pointing" class="inline text-h4 rotate-180" /> or browse all
        posts using <Icon name="index-finger-pointing" class="inline text-h4 rotate-45" />
      </p>
    </div>

    <div>
      <SearchPosts />
    </div>

    <section class="max-w-7xl flex-center flex-col gap-y-5">
      <section
        class="my-10 grid md:grid-cols-2 lg:grid-cols-3 gap-5 auto-rows-fr"
      >
        {
          allPosts
            .sort((a, b) => {
              const dateA = new Date(a.data.pubDate);
              const dateB = new Date(b.data.pubDate);
              return dateB.getTime() - dateA.getTime();
            })
            .slice(0, 9)
            .map((post) => (
              <div>
                <HomepagePostCard post={post} />
              </div>
            ))
        }
      </section>
    </section>
  </main>
</BaseLayout>
